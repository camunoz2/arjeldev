---
import { contentfulClient } from "../../lib/contentful";
import type { BlogPost } from "../../contentfulTypes";
import Layout from "../../layouts/Layout.astro";
import BlogBody from "../../components/BlogBody";

interface Props {
  data: BlogPost;
}

// Generate Blog pages
export async function getStaticPaths() {
  const blogQuery = await contentfulClient.getEntries<BlogPost>({
    content_type: "blogPost",
  });
  const posts = blogQuery.items.map((post) => post.fields);

  return posts.map((post) => {
    return {
      params: { slug: post.slug },
      props: { data: post },
    };
  });
}

const { data }: Props = Astro.props;
---

<Layout title={data.title!}>
  <BlogBody data={data} client:load />
</Layout>
